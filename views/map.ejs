<html>
    <head>
                <!-- Map API-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
        <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
        <link rel="stylesheet" href="/static/index.css">
        
        <title>Map at a specified location</title>
        <link rel="stylesheet" type="text/css" href="https://js.api.here.com/v3/3.1/mapsjs-ui.css" />
        <link rel="stylesheet" type="text/css" href="../template.css" />
        <script type="text/javascript" src='../test-credentials.js'></script>    
        <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-core.js"></script>
        <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-service.js"></script>
        <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-ui.js"></script>
        <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-mapevents.js"></script>
        <script>window.ENV_VARIABLE = 'developer.here.com'</script><script src='/Static/Map.js'></script>
    </head>
    <body>
        <div class="tableBox">
            <h2>Airports</h2>
                <form id="form2">
                    <h4>Filters:</h4>
                    <label for="dist">Max distance from stadium: </label>
                    <select name="dist" id="dist">
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                    <button class="button-2" onclick="fetchAirports()">Search</button>
                </form>
                <table id="airports">
                    <% if (data && data.length > 0) { %>
                        <% data.forEach(entry => { %>
                            <tr>
                                <td><%= entry.AirportName %></td>
                            </tr>
                            <% })} %>
                </table>
            </div>
            <script>
                async function fetchAirports() {
                    const userRange = document.getElementById("dist").value;
                  try {
                    // Make an API fetch request (replace with your actual API URL)
                    const response = await fetch("http://localhost:4000/airport/"+ userRange)
                    //console.log("http://localhost:4000/city/"+ userInputCity)
            
                    if(!response.ok){
                      const errorMessage = `Error: ${response.status} ${response.statusText}`;
                      throw new Error(errorMessage);
                    }
            
                    data = JSON.parse(response.body);
                    alert(""+data);
                    //const data = await response.json(); // Assuming the API returns JSON data
            
                    // Output the data to the console
                    //console.log('API Response1:', data1);
            
                    // Optionally, display the response on the page (if needed)
                    //document.getElementById('apiData').innerHTML = JSON.stringify(data1, null, 2);
            
                  } catch (error) {
                    console.error('Error fetching data:', error);
                  }
                }
                
            </script>
        <!-- <div class="google-map">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3169.429551548009!2d-121.9719523232481!3d37.403320733468895!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x808fc9c827c5f0df%3A0x11455a372e1f7d18!2sLevi&#39;s%20Stadium!5e0!3m2!1sen!2sus!4v1733330480972!5m2!1sen!2sus" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe> </div>
        -->
            <div id="markers-on-the-map">
                <div id="map"></div>
                <script>
                    const myData = ('<%= JSON.stringify(data) %>');
                </script>
                <script type="text/javascript" src='/static/Map.js'></script>
            </div>
    </body>
</html>